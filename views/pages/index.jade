extends ../layout

block content
  include ../includes/splash
  .row(ng-controller="JadeDemos")
    .large-2.columns(style="margin: 20px 0;")
      img.th(src="http://www.gravatar.com/avatar/{{github.gravatar_id}}?s=300", ng-model="github.avatar_url")
    .large-10.columns
      .row
        .small-3.columns.text-right
          p Username:
        .small-9.columns.text-left
          p {{github.login}}
    hr
    .large-12.columns.text-left
      .row
        .small-2.columns.text-right
          p First Name:
        .large-10.columns.text-left    
          input(type="text", ng-model="name.first")
      .row
        .small-2.columns.text-right
          p Last Name:
        .large-10.columns.text-left    
          input(type="text", ng-model="name.last")
      .row
        .small-2.columns.text-right
          p Items
        .large-10.columns
          select(ng-model="selectedItems", ng-options="string for string in stringArray")

      .row
        .large-10.columns.push-2
          ul
            li(ng-repeat="item in items"){{item.name.first}} {{item.string}}
        .large-10.columns
          button.button(ng-click="updateForm()") {{buttonText.save}}
          button.button(ng-click="add()") {{buttonText.add}}
          button.button(ng-click="listGithub()") Get Github URL
          button.button(ng-click="listCoderbits()") Get Coderbits Client

      .row.panel(style="margin: 50px 0; overflow: hidden")
        pre Debug Info: 
        hr
        pre name = {{name}}
        pre stringArray = {{stringArray}}
        pre items = {{items}}
        pre selectedItems = {{selectedItems}}
        pre github = {{github}}
        pre coderbits = {{coderbits}}
  script.

    JadeDemos = function ($scope, $http) {

      $scope.listGithub = (function () {
        $http({method: "GET", url: "https://api.github.com/users/dhigginbotham"}).
          success(function (data, status, headers, config) {
            $scope.github = data;
          });
      })();

      $scope.listCoderbits = function () {
        $http({method: "JSONP", url: "https://coderbits.com/dhz.json?callback=loadCoderbits"})
      };

      loadCoderbits = function (data) {
        $scope.coderbits = data;
      };

      $scope.buttonText = {
        save: "Save",
        add: "Add"
      };


      $scope.updateForm = function() {
        $scope.buttonText.save = "Updated";
      }

      $scope.add = function() {
        $scope.buttonText.add = "Added";
        $scope.items.push({name: {first: $scope.name.first, last: $scope.name.last}, string: $scope.selectedItems});
      }
      
      $scope.name = {
        "first": "Dave",
        "last": "Higginbotham"
      }

      $scope.items = [];
      $scope.stringArray = ['dave', 'higgy', 'is', 'the', 'coolest'];

    };
